<div class="container mt-4">
  <!-- Barre de recherche -->
  <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="mb-3 d-flex">
    <input type="text" formControlName="title" class="form-control form-control-sm me-2"
           placeholder="Rechercher par titre">
    <button type="submit" class="btn btn-primary btn-sm me-2">
      üîç Rechercher
    </button>

    <button type="button" class="btn btn-success btn-sm" (click)="goToAddMission()">
      ‚ûï Ajouter Mission
    </button>
  </form>

  <!-- Tableau -->
  <table class="table table-striped table-sm align-middle">
    <thead class="table-light">
    <tr>
      <th>Titre</th>
      <th>Comp√©tence</th>
      <th>Status</th>
      <th>Start Date</th>
      <th>End Date</th>
      <th>Assignation</th>
      <th class="text-center">Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let mission of missions">
      <td>{{ mission.title }}</td>
      <td>{{ mission.requiredSkill }}</td>
      <td><span
          class="badge"
          [ngClass]="{
        'bg-secondary': mission.status === 'PENDING',
        'bg-primary': mission.status === 'IN_PROGRESS',
        'bg-success': mission.status === 'COMPLETED',
        'bg-danger': mission.status === 'CANCELLATION'
        }">
        {{ mission.status }}
        </span></td>
      <td>{{ mission.startDate | date }}</td>
      <td>{{ mission.endDate | date }}</td>

      <!-- Nouvelle colonne Assignation -->
      <td>
        <button *ngIf="!mission.isAsseigned"
                class="btn btn-outline-success btn-sm"
                (click)="assignMission(mission)">
          Assigner
        </button>
        <button *ngIf="mission.isAsseigned"
                class="btn btn-outline-danger btn-sm"
                (click)="unassignMission(mission)">
          D√©sassigner
        </button>
      </td>

      <!-- Actions -->
      <td class="text-center">
        <i class="bi bi-pencil-square text-warning me-2" role="button"
           (click)="editMission(mission)"></i>
        <i class="bi bi-trash text-danger me-2" role="button"
           (click)="deleteMission1(mission)"></i>
        <i class="bi bi-eye text-primary" role="button"
           (click)="showMissionDetails(mission)"></i>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- Pagination -->
  <nav *ngIf="pageResponse && pageResponse.totalPages && pageResponse.totalPages > 1">
    <ul class="pagination pagination-sm justify-content-center">
      <li class="page-item" [class.disabled]="pageResponse.first">
        <a class="page-link" (click)="goToPage(page - 1)">Pr√©c√©dent</a>
      </li>
      <li class="page-item"
          *ngFor="let p of [].constructor(pageResponse.totalPages); let i = index"
          [class.active]="i === page">
        <a class="page-link" (click)="goToPage(i)">{{ i + 1 }}</a>
      </li>
      <li class="page-item" [class.disabled]="pageResponse.last">
        <a class="page-link" (click)="goToPage(page + 1)">Suivant</a>
      </li>
    </ul>
  </nav>
</div>
